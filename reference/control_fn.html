<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create list of control options (to pass to emuFit()) — control_fn • radEmu</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create list of control options (to pass to emuFit()) — control_fn"><meta name="description" content="Create list of control options (to pass to emuFit())"><meta property="og:description" content="Create list of control options (to pass to emuFit())"><meta property="og:image" content="https://statdivlab.github.io/radEmu/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">radEmu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro_radEmu_with_phyloseq.html">Introduction to radEmu with phyloseq</a></li>
    <li><a class="dropdown-item" href="../articles/intro_radEmu_with_tse.html">Introduction to radEmu with TreeSummarizedExperiment</a></li>
    <li><a class="dropdown-item" href="../articles/intro_radEmu.html">Introduction to radEmu</a></li>
    <li><a class="dropdown-item" href="../articles/parallel_radEmu.html">Parallelizing computation for score tests with radEmu</a></li>
    <li><a class="dropdown-item" href="../articles/radEmu_clustered_data.html">Using radEmu on clustered data</a></li>
    <li><a class="dropdown-item" href="../articles/radEmu_with_reference_taxon.html">Using radEmu with a reference taxon</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/statdivlab/radEmu/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create list of control options (to pass to <code>emuFit()</code>)</h1>
      <small class="dont-index">Source: <a href="https://github.com/statdivlab/radEmu/blob/main/R/control_fn.R" class="external-link"><code>R/control_fn.R</code></a></small>
      <div class="d-none name"><code>control_fn.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create list of control options (to pass to <code><a href="emuFit.html">emuFit()</a></code>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">control_fn</span><span class="op">(</span></span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ignore_stop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_fullmodel_info <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_fullmodel_cov <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_both_cov <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inner_maxit <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  inner_tol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  c1 <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  trackB <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_nullB <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_score_components <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_both_score_pvals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  B_null_tol <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  rho_init <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  constraint_tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  ntries <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>Current control list (optional), will augment it with missing arguments</p></dd>


<dt id="arg-max-step">max_step<a class="anchor" aria-label="anchor" href="#arg-max-step"></a></dt>
<dd><p>Maximum stepsize; update directions computed during estimation (under the alternative).
Will be rescaled if a step in any parameter exceeds this value. Defaults to 1.</p></dd>


<dt id="arg-ignore-stop">ignore_stop<a class="anchor" aria-label="anchor" href="#arg-ignore-stop"></a></dt>
<dd><p>whether to ignore stopping criteria and run <code>maxit</code> iterations (helpful for diagnostic plots to determine convergence).</p></dd>


<dt id="arg-use-fullmodel-info">use_fullmodel_info<a class="anchor" aria-label="anchor" href="#arg-use-fullmodel-info"></a></dt>
<dd><p>Used in estimation under the null hypothesis. Whether to use information matrix from
estimation under the alternative hypothesis to construct the robust score statistic (instead of information
matrix from estimation under the null hypothesis). Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-use-fullmodel-cov">use_fullmodel_cov<a class="anchor" aria-label="anchor" href="#arg-use-fullmodel-cov"></a></dt>
<dd><p>Used in estimation under the null hypothesis. Whether to use covariance matrix from
estimation under the alternative hypothesis to construct the robust score statistic (instead of covariance
matrix from estimation under the null hypothesis). Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-use-both-cov">use_both_cov<a class="anchor" aria-label="anchor" href="#arg-use-both-cov"></a></dt>
<dd><p>Used in estimation under the null hypothesis. Whether to do score test twice, once with
covariance matrix under the alternative hypothesis and once with covariance matrix under the null hypothesis.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-inner-maxit">inner_maxit<a class="anchor" aria-label="anchor" href="#arg-inner-maxit"></a></dt>
<dd><p>Used in estimation under the null hypothesis. Maximum number of iterations within each inner loop
of estimation under null hypothesis algorithm. Default is <code>25</code>.</p></dd>


<dt id="arg-inner-tol">inner_tol<a class="anchor" aria-label="anchor" href="#arg-inner-tol"></a></dt>
<dd><p>Used in estimation under the null hypothesis. Convergence tolerance within each inner loop
of estimation under null hypothesis algorithm. Default is <code>1</code>.</p></dd>


<dt id="arg-c-">c1<a class="anchor" aria-label="anchor" href="#arg-c-"></a></dt>
<dd><p>Used in estimation under the null hypothesis. Parameter for Armijo line search. Default is <code>1e-4</code>.</p></dd>


<dt id="arg-trackb">trackB<a class="anchor" aria-label="anchor" href="#arg-trackb"></a></dt>
<dd><p>Used in estimation under the null hypothesis. When <code>TRUE</code> will track the value of <code>B</code> in each iteration
of optimization algorithm. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-return-nullb">return_nullB<a class="anchor" aria-label="anchor" href="#arg-return-nullb"></a></dt>
<dd><p>Used in estimation under the null hypothesis. When <code>TRUE</code> will return the final value of <code>B</code>
under each null hypothesis tested. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-return-score-components">return_score_components<a class="anchor" aria-label="anchor" href="#arg-return-score-components"></a></dt>
<dd><p>Used in estimation under the null hypothesis. When <code>TRUE</code> will return the components
of the robust score test statistic for each null hypothesis tested. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-return-both-score-pvals">return_both_score_pvals<a class="anchor" aria-label="anchor" href="#arg-return-both-score-pvals"></a></dt>
<dd><p>Used in estimation under the null hypothesis, with <code>use_both_cov</code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-b-null-tol">B_null_tol<a class="anchor" aria-label="anchor" href="#arg-b-null-tol"></a></dt>
<dd><p>Used in estimation under the null hypothesis, for the augmented Lagrangian algorithm.
numeric: convergence tolerance for null model fits for score testing (if max of absolute difference in
B across outer iterations is below this threshold, we declare convergence). Default is <code>0.001</code>.</p></dd>


<dt id="arg-rho-init">rho_init<a class="anchor" aria-label="anchor" href="#arg-rho-init"></a></dt>
<dd><p>Used in estimation under the null hypothesis, for the augmented Lagrangian algorithm.
Value at which to initiate rho parameter in augmented Lagrangian algorithm. Default is <code>1</code>.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Used in estimation under the null hypothesis, for the augmented Lagrangian algorithm.
Value to scale <code>rho</code> by in each iteration of augmented Lagrangian algorithm that does not move estimate
toward zero sufficiently. Default is <code>2</code>.</p></dd>


<dt id="arg-kappa">kappa<a class="anchor" aria-label="anchor" href="#arg-kappa"></a></dt>
<dd><p>Used in estimation under the null hypothesis, for the augmented Lagrangian algorithm. Value
between <code>0</code> and <code>1</code> that determines the cutoff on the ratio of current distance from feasibility over
distance in last iteration triggering scaling of <code>rho</code>. If this ratio is above <code>kappa</code>, <code>rho</code> is scaled
by <code>tau</code> to encourage estimate to move toward feasibility.</p></dd>


<dt id="arg-constraint-tol">constraint_tol<a class="anchor" aria-label="anchor" href="#arg-constraint-tol"></a></dt>
<dd><p>Used in estimation under the null hypothesis, for the augmented Lagrangian algorithm.
Constraint tolerance for fits under null hypotheses (tested element of <code>B</code> must be equal to constraint
function to within this tolerance for a fit to be accepted as a solution to constrained optimization
problem). Default is <code>1e-5</code>.</p></dd>


<dt id="arg-ntries">ntries<a class="anchor" aria-label="anchor" href="#arg-ntries"></a></dt>
<dd><p>Used in estimation under the null hypothesis, for the augmented Lagrangian algorithm.
The number of times to try optimization. Successive tries will change <code>tau</code> and <code>inner_maxit</code> and retry.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing control options, to have more control over optimization algorithms used by <code>radEmu</code>.
This can be passed into <code><a href="emuFit.html">emuFit()</a></code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Clausen, Amy D Willis, Sarah Teichman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

